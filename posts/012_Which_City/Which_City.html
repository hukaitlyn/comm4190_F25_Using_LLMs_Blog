<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kaitlyn Hu">
<meta name="dcterms.date" content="2025-10-17">
<meta name="description" content="I asked an LLM to rank the best cities in the world for people in their early 20s and compared its logic to my own experience as an international student.">

<title>From Taipei to Philadelphia: Asking AI Where a 20 Something Belongs – Coffee, Curiosity, and Chatbots!</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-fa6ebe1abc24c69c1ddb9a141d0fa116.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Coffee, Curiosity, and Chatbots!</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About the Author</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/_kaitlynhu/"> <i class="bi bi-instagram" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/hukaitlyn"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">From Taipei to Philadelphia: Asking AI Where a 20 Something Belongs</h1>
                  <div>
        <div class="description">
          I asked an LLM to rank the best cities in the world for people in their early 20s and compared its logic to my own experience as an international student.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">Life Abroad</div>
                <div class="quarto-category">International Student</div>
                <div class="quarto-category">Adulting</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kaitlyn Hu </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 17, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><img src="city.webp" class="img-fluid"></p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction"><strong>Introduction:</strong></h2>
<p>Growing up in Taipei spoiled me in the best way. Everything was easy. Food at every hour. Public transit that actually works. Streets that feel alive but never overwhelming. When I moved to Philadelphia for college, it honestly felt like learning how to live all over again. Suddenly I had to think about safety, transportation, groceries, weather, everything. I didn’t realize how much a city shapes your daily life until I had to start rebuilding those routines from scratch.</p>
<p>Now that I’m in my early twenties and about to graduate, I keep wondering what comes next. Where am I supposed to go after this? What city actually makes sense for the kind of adult life I want? I still don’t fully know what that looks like, but I do know that choosing where to live feels like choosing a version of myself.</p>
<p>So for fun, and maybe also out of mild panic, I decided to ask an LLM to rank cities around the world for someone in their early twenties trying to figure things out. I wanted to see what it would pick based on things like affordability, community, nightlife, culture, and general vibes. Not because AI has all the answers, but because I’m curious whether it can help me think about this in a new way. Maybe it’ll give me ideas. Maybe it’ll tell me something I already knew. Either way, it feels like a pretty entertaining experiment while I try to sort out my next steps.</p>
</section>
<section id="prompt" class="level2">
<h2 class="anchored" data-anchor-id="prompt"><strong>Prompt:</strong></h2>
<blockquote class="blockquote">
<p>I’m in my early twenties, about to graduate, and trying to figure out where I should live next. I grew up in Taipei and currently study in Philadelphia, so I’m used to cities with very different lifestyles. Can you rank around 10 cities around the world that would be great for someone in my stage of life?</p>
</blockquote>
<blockquote class="blockquote">
<p>Consider things like affordability, job opportunities, social life, walkability, public transportation, general safety, community feel, dating and friendships, culture, food, and overall quality of life for young people.</p>
</blockquote>
<blockquote class="blockquote">
<p>For each city, give a short explanation of why it might be a good fit. Also tell me which cities might match someone who grew up in Taipei, and which feel closer to Philadelphia.</p>
</blockquote>
<blockquote class="blockquote">
<p>If you need more details about what I want or my personality, ask me first.</p>
</blockquote>
</section>
<section id="response" class="level2">
<h2 class="anchored" data-anchor-id="response"><strong>Response:</strong></h2>
<blockquote class="blockquote">
<p>This is a fantastic question, and your background in both Taipei and Philadelphia gives you a unique perspective! You’ve experienced very different urban environments, which will help you appreciate the nuances of other cities. I’ll rank around 10 cities that offer a great balance for someone in their early twenties, focusing on the criteria you mentioned. “Affordability” is always relative, especially in global cities, so I’ll consider it in comparison to other major hubs.</p>
</blockquote>
<blockquote class="blockquote">
<h3 id="top-cities-for-early-twenties-graduates" class="anchored">Top Cities for Early-Twenties Graduates</h3>
<p><strong>1. Berlin, Germany</strong> Why it’s a great fit: Berlin is a magnet for young people due to its unique blend of history, vibrant arts scene, and burgeoning tech industry. It’s relatively affordable compared to other major European capitals, especially for rent. The social scene is incredibly diverse, with countless bars, clubs, cafes, and cultural events. Public transport is excellent, and the city is very bike-friendly. There’s a strong international community, making it easier to meet people. Job opportunities are growing, particularly in startups and tech. The food scene is varied and affordable, and safety is generally high. Key Strengths: Culture, affordability (relative), social life, public transport, job opportunities (tech).</p>
<p><strong>2. Lisbon, Portugal</strong> Why it’s a great fit: Lisbon has exploded in popularity, and for good reason. It offers an incredibly high quality of life at a more affordable price point than many Western European cities. The city is stunning, with a vibrant social scene, delicious food, and a warm climate. There’s a growing tech and startup ecosystem, attracting many young professionals. Walkability is high (though hilly!), and public transport is good. The community feel is welcoming, and it’s easy to meet people, especially with the influx of expats. Dating and friendships thrive in its relaxed atmosphere. Key Strengths: Affordability (relative), social life, culture, food, climate, growing job market.</p>
<p><strong>3. Toronto, Canada</strong> Why it’s a great fit: Toronto is a truly multicultural metropolis with a robust economy and diverse job opportunities across many sectors (finance, tech, media, healthcare). It’s incredibly safe, has excellent public transportation, and boasts a vibrant social scene with endless options for food, nightlife, and culture. While not cheap, it offers a higher earning potential than some European cities. It’s very walkable in many neighborhoods, and the community is highly welcoming to newcomers and international residents. Key Strengths: Job opportunities, diversity, safety, public transport, social life, culture.</p>
<p><strong>4. Melbourne, Australia</strong> Why it’s a great fit: Consistently ranked among the world’s most livable cities, Melbourne offers an exceptional quality of life. It’s renowned for its arts, culture, food, and coffee scene. Job opportunities are strong, especially in finance, healthcare, and tech. The city is very walkable, with an extensive tram network. It has a lively social scene, great community feel, and a strong emphasis on outdoor activities. While rent can be high, salaries are generally competitive. Key Strengths: Quality of life, culture, food, job opportunities, safety, public transport.</p>
<p><strong>5. Amsterdam, Netherlands</strong> Why it’s a great fit: Amsterdam offers a fantastic quality of life, especially for young people. It’s incredibly international, with a large expat community, making it easy to meet people. The city is beautiful, very safe, and highly walkable/bikeable with excellent public transport. Job opportunities are good, particularly in tech, creative industries, and international business, and many companies operate in English. The social scene is vibrant, and there’s a strong emphasis on work-life balance. The main drawback is the high cost of living, especially for housing. Key Strengths: Quality of life, international community, safety, walkability/biking, job opportunities, culture.</p>
<p><strong>6. Chicago, USA</strong> Why it’s a great fit: For a major US city, Chicago offers a surprisingly good balance of job opportunities, culture, and relative affordability (compared to NYC or SF). It’s a major hub for finance, tech, healthcare, and manufacturing. The city has stunning architecture, world-class museums, a fantastic food scene, and passionate sports culture. Public transport is decent, and many areas are walkable. The social scene is lively, and it’s easier to build a community than in some other large US cities. Safety varies by neighborhood, but generally improving in core areas. Key Strengths: Job opportunities, affordability (relative for US), culture, food, public transport (for US).</p>
<p><strong>7. Montreal, Canada</strong> Why it’s a great fit: Montreal offers a unique blend of North American dynamism and European charm. It’s significantly more affordable than Toronto or Vancouver, making it very attractive for recent graduates. The city is bilingual (French and English), which adds to its cultural richness. It has a thriving arts and music scene, excellent food, and a vibrant nightlife. Job opportunities exist, particularly in tech, gaming, aerospace, and creative industries. Public transport is efficient, and the city is very walkable. It has a strong community feel, especially within its distinct neighborhoods. Key Strengths: Affordability (relative for NA), culture, food, social life, unique vibe, public transport.</p>
<p><strong>8. Singapore</strong> Why it’s a great fit: If career growth, safety, and efficiency are top priorities, Singapore is hard to beat. It’s a global hub for finance, tech, and logistics, offering abundant high-paying job opportunities. The public transportation system is world-class, and the city is incredibly safe and clean. Food is a national obsession, with hawker centers offering delicious and affordable meals. There’s a large expat community. The main downsides are the extremely high cost of living (especially housing and cars) and a potentially more structured social scene compared to some Western cities. Key Strengths: Job opportunities, safety, public transport, food, efficiency, cleanliness.</p>
<p><strong>9. Barcelona, Spain</strong> Why it’s a great fit: Barcelona offers an incredible lifestyle with beautiful architecture, fantastic food, a vibrant nightlife, and proximity to beaches and mountains. It’s very walkable, with good public transport. The social scene is lively, and there’s a strong sense of community. While the cost of living is rising, it’s still relatively affordable compared to Northern European capitals. The main challenge for a recent grad might be job opportunities, especially if you don’t speak Spanish or Catalan, and salaries can be lower. However, it’s a great place for cultural immersion and enjoying life. Key Strengths: Lifestyle, culture, food, social life, walkability, climate.</p>
<p><strong>10. Seoul, South Korea</strong> Why it’s a great fit: Seoul is a dynamic, high-tech metropolis with an incredibly efficient public transport system, amazing food, and a vibrant youth culture. It’s very safe, and there’s always something happening, from K-pop concerts to traditional markets. Job opportunities are strong in tech, media, and design, especially if you have specialized skills or Korean language proficiency. It offers a unique cultural experience and a fast-paced environment. The main challenges can be the language barrier if you don’t speak Korean, and the job market can be competitive for foreigners without specific in-demand skills or a strong network. Key Strengths: Culture, food, safety, public transport, technology, dynamism.</p>
</blockquote>
<blockquote class="blockquote">
<h3 id="which-cities-might-match-someone-who-grew-up-in-taipei" class="anchored">Which cities might match someone who grew up in Taipei?</h3>
<p>Someone who grew up in Taipei would likely appreciate cities that share some of its characteristics: Efficient and extensive public transportation: Taipei’s MRT is excellent. High safety: Taipei is very safe. Vibrant and diverse food culture: Street food and diverse dining options are key. High density and walkability: A compact, easy-to-navigate urban environment. Strong work ethic and modern infrastructure: A sense of progress and efficiency. Cleanliness and order (relative to other cities).</p>
<p><strong>Cities that might resonate with a Taipei background:</strong> 1. Singapore: This is probably the closest match. It shares Taipei’s hyper-efficiency, incredible safety, world-class public transport, and a fervent food culture (especially hawker centers). It’s also very clean and modern, with a strong emphasis on career progression. 2. Seoul, South Korea: Shares the high-tech integration, incredibly efficient public transport, high safety, and a dynamic, youth-driven culture with fantastic food. The urban density and constant activity would feel familiar. 3. Amsterdam, Netherlands: While culturally very different, it shares the excellent public transport, high safety, and a very bike-friendly, dense urban environment where things generally work efficiently. 4. Melbourne, Australia: While not as dense as Taipei, it has a strong food culture, excellent public transport (trams!), and a high quality of life with a sense of order and cleanliness.</p>
</blockquote>
<blockquote class="blockquote">
<h3 id="which-cities-feel-closer-to-philadelphia" class="anchored">Which cities feel closer to Philadelphia?</h3>
<p>Someone who studied in Philadelphia might appreciate cities that share some of its characteristics: Distinct neighborhoods with unique identities: Philly is known for its diverse neighborhoods. Historical significance and a sense of “grit” or authenticity: A less polished, more real urban feel. Strong sports culture: Philly fans are passionate. Walkable areas but also reliance on cars in some parts: A mix of urban and suburban accessibility. A strong sense of local community within a larger city. North American urban structure and lifestyle.</p>
<p><strong>Cities that might feel closer to Philadelphia:</strong> 1. Chicago, USA: This is likely the closest match. Chicago shares Philly’s distinct neighborhoods, strong sports culture, impressive architecture, and a similar “big city, but not overwhelming” feel compared to NYC. It also offers a similar blend of historical significance and modern urban life, with a strong sense of local identity. 2. Montreal, Canada: While bilingual, Montreal shares a similar historical depth, distinct neighborhood feel, and a strong sense of local culture. It has a more European flair but still operates within a North American context, offering a unique blend that might resonate. 3. Toronto, Canada: As a major North American city, Toronto shares the diverse population, a strong economy, and a similar urban structure to many US cities. While perhaps less “gritty” than Philly, its diverse neighborhoods and strong community feel would be familiar.</p>
</blockquote>
<blockquote class="blockquote">
<p>I hope this detailed breakdown helps you narrow down your choices! Each city offers a unique experience, and your personal priorities will ultimately guide your decision. Good luck with your graduation and your next big adventure!</p>
</blockquote>
</section>
<section id="reflection" class="level2">
<h2 class="anchored" data-anchor-id="reflection"><strong>Reflection:</strong></h2>
<p>Reading the AI’s ranking was actually pretty fun. It did a good job breaking down each city in terms of things that matter in your early twenties, like community, food, job opportunities, and what the overall vibe feels like. I also liked how it compared cities that would feel familiar to someone from Taipei versus someone who has lived in Philadelphia. That part felt surprisingly accurate.</p>
<p>What I didn’t love was how casually it treated affordability. Some of the cities on the list are objectively expensive, and the AI sometimes glosses over that reality. I also wish it had offered a few more unexpected choices instead of sticking mostly to well-known global hubs.</p>
<p>Still, the list helped me realize what I actually care about in a city: safety, good public transportation, a strong food culture, and a sense of community. It also made me think about how much a city influences the version of myself I become. Even though AI can’t tell me exactly where to go after graduation, it did help me organize my thoughts and see the decision in a new way.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/hukaitlyn\.github\.io\/comm4190_F25_Using_LLMs_Blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>